@using Falcon.Web.Mvc.HtmlExtensions
@model Vino.Server.Services.MainServices.CRM.Port.Model.PortModel
@{
}
<div class="modal-content">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Thêm mới</h4>
    </div>
    <div class="modal-body">
        <section class="wr-main">
            <div class="out-content-mid no-mb no-minheight">
                <div class="container-fluid">
                    <div class="row" id="form_new">
                        <div class="col-sm-12 col-md-6 col-lg-12">
                            <div class="out-input">
                                <label>Port Code</label>
                                @Html.EditorFor(model => model.PortCode, 
                                    new { htmlAttributes = new { Id = Html.FieldIdFor(m => m.PortCode), @class = "form-control"} })
                                @*<input type="text" value=@Model.JobID class="form-control" placeholder="">*@
                                <div class="color-danger p-t-10" style="display: none;">Please input data</div>
                            </div>
                        </div>

                        <div class="col-sm-12 col-md-6 col-lg-12">
                            <div class="out-input">
                                <label>Port Name</label>
                                @Html.EditorFor(model => model.PortName,
                                    new { htmlAttributes = new { Id = Html.FieldIdFor(m => m.PortName), @class = "form-control" } })
                                @*<input type="text" value=@Model.JobID class="form-control" placeholder="">*@
                                <div class="color-danger p-t-10" style="display: none;">Please input data</div>
                            </div>
                        </div>

                        <div class="col-sm-12 col-md-6 col-lg-12">
                            <div class="out-input">
                                <label>Nationality</label>
                                @Html.DropDownListFor(model => model.NationalityId,
                                    new SelectList(Model.NationalityItems, "Value", "Text"), 
                                    new { Id = Html.FieldIdFor(m => m.NationalityId), @class = "form-control select-style-1" })
                            </div>
                        </div>

                        <div class="col-sm-12 col-md-6 col-lg-12">
                            <div class="out-input">
                                <label>Zone</label>
                                @Html.DropDownListFor(model => model.ZoneId, new SelectList(Model.ZoneItems, "Value", "Text"),
                                    new { Id = Html.FieldIdFor(m => m.ZoneId), @class = "form-control select-style-1" })
                                <div id="div-error-message-item" class="color-danger p-t-10" style="display: none;">Please input data</div>
                            </div>
                        </div>

                        <div class="col-sm-12 col-md-6 col-lg-12">
                            <div class="out-input">
                                <label>Local Zone</label>
                                @Html.EditorFor(model => model.LocalZone,
                                    new { htmlAttributes = new { Id = Html.FieldIdFor(m => m.LocalZone), @class = "form-control" } })
                                @*<input type="text" value=@Model.JobID class="form-control" placeholder="">*@
                                <div id="div-error-message-item" class="color-danger p-t-10" style="display: none;">Please input data</div>
                            </div>
                        </div>

                        <div class="col-sm-12 col-md-6 col-lg-12">
                            <div class="out-input">
                                <label>Mode</label>
                                @Html.DropDownListFor(model => model.ModeId, new SelectList(Model.ModeItems, "Value", "Text"),
                                    new { Id = Html.FieldIdFor(m => m.ModeId), @class = "form-control select-style-1" })
                            </div>
                        </div>

                    </div>
                </div>
            </div>

        </section>

    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
        <button type="button" id="btn-save-contact" onclick="SavePort()" class="btn btn-primary">Lưu</button>
    </div>
</div>
<script type="text/javascript">
        function SavePort () {
            console.log("Save port button click");
            var model = JSON.stringify(GetDataRequest());
            $.ajax({
                url: "@Url.Action("CreateFromSubViewAsync", "Port")",
                type: "POST",
                dataType: "json",
                contentType: 'application/json',
                data: model,
                cache: false,
                async: true,
                success: function (dataJs) {
                    let groupIds = dataJs.GroupIds.split(',');
                    $.each(groupIds, function(index, value) {
                        $("#" + value).data("kendoComboBox").dataSource.read();
                    });

                    let viewIds = dataJs.ViewIds;
                    $("#" + viewIds).data("kendoComboBox").value(dataJs.Value);
                    $('#myModal').modal('hide');

                },
                error: function (xhr, ajaxOptions, thrownError) {
                    console.log('Error saving contacts in ajax ' + xhr.error + thrownError.error);
                }
            });
        };

        function GetDataRequest() {
            return {
                PortCode : $('#@Html.FieldIdFor(model => model.PortCode)').val(),
                PortName: $('#@Html.FieldIdFor(model => model.PortName)').val(),
                NationalityId: $('#@Html.FieldIdFor(model => model.NationalityId)').val(),
                ZoneId: $('#@Html.FieldIdFor(model => model.ZoneId)').val(),
                LocalZone: $('#@Html.FieldIdFor(model => model.LocalZone)').val(),
                ModeId: $('#@Html.FieldIdFor(model => model.ModeId)').val()
            };
        }

</script>




