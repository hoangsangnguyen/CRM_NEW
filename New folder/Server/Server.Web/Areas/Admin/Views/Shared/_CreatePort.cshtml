@using Falcon.Web.Mvc.HtmlExtensions
@model Vino.Server.Web.Areas.Admin.Controllers.PortController.ModelAndViewId
@{
    var port = Model.Port;
    var viewId = Model.ViewId;
    var viewGroupId = Model.ViewGroupId;
}
<div class="modal-content">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Thêm mới @viewGroupId</h4>
    </div>
    <div class="modal-body">
        <section class="wr-main">
            <div class="out-content-mid no-mb no-minheight">
                <div class="container-fluid">
                    <div class="row" id="form_new">
                        <div class="col-sm-12 col-md-6 col-lg-12">
                            <div class="out-input">
                                <label>Port Code</label>
                                @Html.EditorFor(model => model.Port.PortCode, 
                                    new { htmlAttributes = new { Id = Html.FieldIdFor(m => m.Port.PortCode), @class = "form-control"} })
                                @*<input type="text" value=@Model.JobID class="form-control" placeholder="">*@
                                <div class="color-danger p-t-10" style="display: none;">Please input data</div>
                            </div>
                        </div>

                        <div class="col-sm-12 col-md-6 col-lg-12">
                            <div class="out-input">
                                <label>Port Name</label>
                                @Html.EditorFor(model => model.Port.PortName,
                                    new { htmlAttributes = new { Id = Html.FieldIdFor(m => m.Port.PortName), @class = "form-control" } })
                                @*<input type="text" value=@Model.JobID class="form-control" placeholder="">*@
                                <div class="color-danger p-t-10" style="display: none;">Please input data</div>
                            </div>
                        </div>

                        <div class="col-sm-12 col-md-6 col-lg-12">
                            <div class="out-input">
                                <label>Nationality</label>
                                @Html.DropDownListFor(model => model.Port.NationalityId,
                                    new SelectList(Model.Port.NationalityItems, "Value", "Text"), 
                                    new { Id = Html.FieldIdFor(m => m.Port.NationalityId), @class = "form-control select-style-1" })
                            </div>
                        </div>

                        <div class="col-sm-12 col-md-6 col-lg-12">
                            <div class="out-input">
                                <label>Zone</label>
                                @Html.DropDownListFor(model => model.Port.ZoneId, new SelectList(Model.Port.ZoneItems, "Value", "Text"),
                                    new { Id = Html.FieldIdFor(m => m.Port.ZoneId), @class = "form-control select-style-1" })
                                <div id="div-error-message-item" class="color-danger p-t-10" style="display: none;">Please input data</div>
                            </div>
                        </div>

                        <div class="col-sm-12 col-md-6 col-lg-12">
                            <div class="out-input">
                                <label>Local Zone</label>
                                @Html.EditorFor(model => model.Port.LocalZone,
                                    new { htmlAttributes = new { Id = Html.FieldIdFor(m => m.Port.LocalZone), @class = "form-control" } })
                                @*<input type="text" value=@Model.JobID class="form-control" placeholder="">*@
                                <div id="div-error-message-item" class="color-danger p-t-10" style="display: none;">Please input data</div>
                            </div>
                        </div>

                        <div class="col-sm-12 col-md-6 col-lg-12">
                            <div class="out-input">
                                <label>Mode</label>
                                @Html.DropDownListFor(model => model.Port.ModeId, new SelectList(Model.Port.ModeItems, "Value", "Text"),
                                    new { Id = Html.FieldIdFor(m => m.Port.ModeId), @class = "form-control select-style-1" })
                            </div>
                        </div>

                    </div>
                </div>
            </div>

        </section>

    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
        <button type="button" id="btn-save-contact" onclick="SavePort()" class="btn btn-primary">Lưu</button>
    </div>
</div>
<script type="text/javascript">
        function SavePort () {
            console.log("Save port button click");
            var model = JSON.stringify(GetDataRequest());
            $.ajax({
                url: "@Url.Action("CreateFromSubViewAsync", "Port")",
                type: "POST",
                dataType: "json",
                contentType: 'application/json',
                data: model,
                cache: false,
                async: true,
                success: function (dataJs) {
                   // debugger;
                    //let viewGroupId = @viewGroupId;
                    $(".DrpPort").each(function() {
                        $(this).append($('<option>', {
                            value: dataJs.Value,
                            text: dataJs.Name
                        }));
                    });

                    let viewId = @viewId;
                    $("#" + viewId.id).val(dataJs.Value);
                    $('#myModal').modal('hide');

                },
                error: function (xhr, ajaxOptions, thrownError) {
                    console.log('Error saving contacts in ajax ' + xhr.error + thrownError.error);
                }
            });
        };

        function GetDataRequest() {
            return {
                PortCode : $('#@Html.FieldIdFor(model => model.Port.PortCode)').val(),
                PortName: $('#@Html.FieldIdFor(model => model.Port.PortName)').val(),
                NationalityId: $('#@Html.FieldIdFor(model => model.Port.NationalityId)').val(),
                ZoneId: $('#@Html.FieldIdFor(model => model.Port.ZoneId)').val(),
                LocalZone: $('#@Html.FieldIdFor(model => model.Port.LocalZone)').val(),
                ModeId: $('#@Html.FieldIdFor(model => model.Port.ModeId)').val()
            };
        }

</script>




